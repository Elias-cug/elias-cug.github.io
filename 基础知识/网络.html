<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>网络 | Elias Notes | Front-End Notes</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/logo.jpeg">
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.f6817f1a.css" as="style"><link rel="preload" href="/assets/js/app.4c273015.js" as="script"><link rel="preload" href="/assets/js/2.2aff70d4.js" as="script"><link rel="preload" href="/assets/js/18.5611296e.js" as="script"><link rel="prefetch" href="/assets/js/10.f4cbcff0.js"><link rel="prefetch" href="/assets/js/11.4142fc0c.js"><link rel="prefetch" href="/assets/js/12.79cdaa0c.js"><link rel="prefetch" href="/assets/js/13.bf21eec3.js"><link rel="prefetch" href="/assets/js/14.bceb7261.js"><link rel="prefetch" href="/assets/js/15.9a4809fa.js"><link rel="prefetch" href="/assets/js/16.08a352ba.js"><link rel="prefetch" href="/assets/js/17.cc8a0890.js"><link rel="prefetch" href="/assets/js/19.26696b64.js"><link rel="prefetch" href="/assets/js/20.7fb62a04.js"><link rel="prefetch" href="/assets/js/21.e1c074c9.js"><link rel="prefetch" href="/assets/js/22.660cc37e.js"><link rel="prefetch" href="/assets/js/23.4695b80b.js"><link rel="prefetch" href="/assets/js/24.8c84609e.js"><link rel="prefetch" href="/assets/js/25.f989ee8a.js"><link rel="prefetch" href="/assets/js/3.0625cd77.js"><link rel="prefetch" href="/assets/js/4.e1c5e78c.js"><link rel="prefetch" href="/assets/js/5.2ca887b4.js"><link rel="prefetch" href="/assets/js/6.830f519f.js"><link rel="prefetch" href="/assets/js/7.90bf487e.js"><link rel="prefetch" href="/assets/js/8.8864ba6b.js"><link rel="prefetch" href="/assets/js/9.fedeec11.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f6817f1a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Elias Notes | Front-End Notes</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="基础" class="dropdown-title"><span class="title">基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="基础" class="mobile-dropdown-title"><span class="title">基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/基础知识/javascript.html" class="nav-link">
    javascript
  </a></li><li class="dropdown-item"><!----> <a href="/基础知识/css.html" class="nav-link">
    css
  </a></li><li class="dropdown-item"><!----> <a href="/基础知识/网络.html" class="nav-link">
    网络
  </a></li><li class="dropdown-item"><!----> <a href="/基础知识/浏览器.html" class="nav-link">
    浏览器
  </a></li><li class="dropdown-item"><!----> <a href="/基础知识/后端.html" class="nav-link">
    后端
  </a></li><li class="dropdown-item"><!----> <a href="/基础知识/计算机.html" class="nav-link">
    计算机
  </a></li><li class="dropdown-item"><!----> <a href="/基础知识/图形学.html" class="nav-link">
    图形学
  </a></li><li class="dropdown-item"><!----> <a href="/基础知识/常用命令.html" class="nav-link">
    常用命令
  </a></li><li class="dropdown-item"><!----> <a href="/基础知识/typescript.html" class="nav-link">
    TypeScript
  </a></li><li class="dropdown-item"><!----> <a href="/基础知识/工具函数.html" class="nav-link">
    工具函数
  </a></li><li class="dropdown-item"><!----> <a href="/基础知识/APIJSON.html" class="nav-link">
    APIJSON
  </a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架" class="dropdown-title"><span class="title">框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="框架" class="mobile-dropdown-title"><span class="title">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/框架/webpack.html" class="nav-link">
    Webpack
  </a></li><li class="dropdown-item"><!----> <a href="/框架/react.html" class="nav-link">
    React
  </a></li><li class="dropdown-item"><!----> <a href="/框架/单体仓库.html" class="nav-link">
    单体仓库
  </a></li><li class="dropdown-item"><!----> <a href="/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/框架/VUE.html" class="nav-link">
    VUE
  </a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="基础" class="dropdown-title"><span class="title">基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="基础" class="mobile-dropdown-title"><span class="title">基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/基础知识/javascript.html" class="nav-link">
    javascript
  </a></li><li class="dropdown-item"><!----> <a href="/基础知识/css.html" class="nav-link">
    css
  </a></li><li class="dropdown-item"><!----> <a href="/基础知识/网络.html" class="nav-link">
    网络
  </a></li><li class="dropdown-item"><!----> <a href="/基础知识/浏览器.html" class="nav-link">
    浏览器
  </a></li><li class="dropdown-item"><!----> <a href="/基础知识/后端.html" class="nav-link">
    后端
  </a></li><li class="dropdown-item"><!----> <a href="/基础知识/计算机.html" class="nav-link">
    计算机
  </a></li><li class="dropdown-item"><!----> <a href="/基础知识/图形学.html" class="nav-link">
    图形学
  </a></li><li class="dropdown-item"><!----> <a href="/基础知识/常用命令.html" class="nav-link">
    常用命令
  </a></li><li class="dropdown-item"><!----> <a href="/基础知识/typescript.html" class="nav-link">
    TypeScript
  </a></li><li class="dropdown-item"><!----> <a href="/基础知识/工具函数.html" class="nav-link">
    工具函数
  </a></li><li class="dropdown-item"><!----> <a href="/基础知识/APIJSON.html" class="nav-link">
    APIJSON
  </a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架" class="dropdown-title"><span class="title">框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="框架" class="mobile-dropdown-title"><span class="title">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/框架/webpack.html" class="nav-link">
    Webpack
  </a></li><li class="dropdown-item"><!----> <a href="/框架/react.html" class="nav-link">
    React
  </a></li><li class="dropdown-item"><!----> <a href="/框架/单体仓库.html" class="nav-link">
    单体仓库
  </a></li><li class="dropdown-item"><!----> <a href="/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/框架/VUE.html" class="nav-link">
    VUE
  </a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" aria-current="page" class="sidebar-link">知识梳理</a></li><li><a href="/基础知识/javascript.html" class="sidebar-link">javascript</a></li><li><a href="/基础知识/css.html" class="sidebar-link">CSS</a></li><li><a href="/基础知识/网络.html" class="active sidebar-link">网络</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/基础知识/网络.html#ssl握手" class="sidebar-link">SSL握手</a></li><li class="sidebar-sub-header"><a href="/基础知识/网络.html#http-2-x" class="sidebar-link">http/2.x</a></li><li class="sidebar-sub-header"><a href="/基础知识/网络.html#websocket" class="sidebar-link">websocket</a></li><li class="sidebar-sub-header"><a href="/基础知识/网络.html#强缓存-协商缓存" class="sidebar-link">强缓存&amp;协商缓存</a></li><li class="sidebar-sub-header"><a href="/基础知识/网络.html#http-的头部" class="sidebar-link">http 的头部</a></li><li class="sidebar-sub-header"><a href="/基础知识/网络.html#http规范" class="sidebar-link">http规范</a></li><li class="sidebar-sub-header"><a href="/基础知识/网络.html#tcp-和-udp-的区别" class="sidebar-link">tcp 和 udp 的区别</a></li><li class="sidebar-sub-header"><a href="/基础知识/网络.html#cdn" class="sidebar-link">CDN</a></li></ul></li><li><a href="/基础知识/浏览器.html" class="sidebar-link">浏览器</a></li><li><a href="/基础知识/后端.html" class="sidebar-link">后端</a></li><li><a href="/基础知识/计算机.html" class="sidebar-link">计算机</a></li><li><a href="/基础知识/图形学.html" class="sidebar-link">图形学</a></li><li><a href="/基础知识/常用命令.html" class="sidebar-link">常用命令</a></li><li><a href="/基础知识/typescript.html" class="sidebar-link">TypeScript</a></li><li><a href="/基础知识/工具函数.html" class="sidebar-link">工具函数</a></li><li><a href="/基础知识/APIJSON.html" class="sidebar-link">APIJSON</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="网络"><a href="#网络" class="header-anchor">#</a> 网络</h1> <h2 id="ssl握手"><a href="#ssl握手" class="header-anchor">#</a> SSL握手</h2> <p><strong>要做什么事情</strong></p> <ol><li>交换协议版本号</li> <li>选择一个两端都了解的密码</li> <li>对两端的身份进行认证</li> <li>生成临时的会话密钥，以便加密信道</li></ol> <p><strong>握手过程</strong></p> <ol><li><p>建立到服务器端口 443 的 tcp 连接</p></li> <li><p>SSL 安全参数握手</p> <p>1). 客户端发送过一个它自己支持的算法列表，同时发送的含有不重数 nonce1</p> <p>2). 服务器从列表中选择算法：发送回来它的算法选择+服务器证书+服务器不重数nonce2</p> <p>3). <strong>客户端验证证书</strong>，提取出服务器的公钥，生成pre_master_secret（采用服务器 加密的），发送到服务器</p> <p>4). 客户端和服务器从pre_master_secret 和 2 个 nonces 独立地计算出主密钥MS。（由MS切片得到2个数据传输密钥和2个MAC密钥保证数据完整性的一种密钥）</p> <p>5). 客户端发送一个整个握手阶段报文的MAC</p> <p>6). 服务器发送一个整个握手阶段报文的MAC</p></li> <li><p>在 SSL 上发送 HTTP 请求/在 TCP 上发送已加密请求</p></li> <li><p>在 SSL 上发送 HTTP 响应/ 在 TCP 上发送已加密的响应</p></li> <li><p>SSL 关闭通知</p></li> <li><p>TCP 连接关闭</p></li></ol> <blockquote><p>MAC是指消息认真码（带密钥的hash函数）：密码学中，通信实体双方使用的一种验证机制，保证消息数据完整性的一种工具。</p></blockquote> <p><strong>证书验证</strong></p> <blockquote><p>SSL 自身不要求用户检查 Web 服务器证书，但大部分现代浏览器会对证书进行简单的完整性检查。网景公司提出的一种 web 服务器证书有效性算法时大部分浏览器有效性验证的基础的基础。</p></blockquote> <ol><li><p>日期检测</p></li> <li><p>签名颁发者可信度检测 --》🍎 证书链</p> <p>每个证书都是由某些证书颁发机构（CA）签发的，他们负责为服务器担保。任何人都可以生成证书，但有一些很著名。浏览器会附带一个签名颁发机构的受信列表。如果收到未知的，就会警告。</p></li> <li><p>签名检测</p> <p>一旦判定签名授权时可信的，浏览器就要对签名使用签名颁发机构的公开密钥并将其与校验码进行比较，以查看证书的完整性</p></li> <li><p>站点身份检测</p> <p>为防止服务器赋值其他人的证书，或拦截其他人的流量，大部分浏览器都会试着去验证证书中的域名与他们所对话的服务器域名是否匹配。</p></li></ol> <p><strong>常见的算法</strong></p> <ol><li>对称加密算法：DES AES</li> <li>非对称加密算法：RSA</li> <li>报文摘要算法：MD5 SHA-1</li></ol> <p><strong>不加密的通信带来什么问题</strong></p> <ol><li>窃听风险（eavesdropping）：第三方可以获知通信内容</li> <li>篡改风险（tampering）：第三方可以修改通信内容</li> <li>冒充风险（pretending）：第三方可以冒充他人身份参与通信</li></ol> <h2 id="http-2-x"><a href="#http-2-x" class="header-anchor">#</a> http/2.x</h2> <p><strong>二进制分帧</strong></p> <ol><li>帧（frame）包含部分：类型type，长度Length，标记Flags，流标识Stream和frame payload有效载荷。</li> <li>消息：一个完整的请求或者响应，比如请求，响应等。由一个或多个frame组成</li> <li>流：流是链接中的一个虚拟信道，可以承载双向消息传输。每个流有唯一整数标识。为防止两端流ID冲突，客户端发起的流具有奇数ID，服务端发起的流具有偶数ID。</li></ol> <p><strong>多路复用</strong></p> <p>有了新的分帧机制后，http/2不再依赖多个TCP链接去实现多流并行了。每个数据流都没拆分成很多互不依赖的帧，而这些帧可以乱序发送，还可以分优先级，最后再在另一端把他们重新组合起来。
http/2连接都是持久化的，而且客户端与服务器之间也需要一个连接（每个域名一个连接）。http/2可以承载数十或数百个流的复用，多路复用意味着来自很多流的数据包能够混合在一起通过同样的连接传输。当到达终点时，再根据不同帧的首部的流标识重新连接将不同的数据流进行组装</p> <p><strong>头部压缩</strong></p> <p>http/2使用encoder来减少需要传输的header大小，通讯双方各自缓存一份头部字段表，既避免了重复header的传输，又减少了需要传输的大小。</p> <p>http/2关注的是首部压缩，http/2使用的是专门为首部压缩设计的HPACK算法</p> <p><strong>请求优先级</strong></p> <ol><li><p>把http消息分为很多独立帧后，就可以通过优化这些帧的交错和传输顺序进一步优化性能</p></li> <li><p>服务器可以根据流的优先级，控制资源分配，而在响应数据准备好后优先将最高优先级的帧发送给客户端</p></li></ol> <p><strong>服务端推送</strong></p> <p>服务器可以对一个客户端请求发送多个响应，服务端向客户端推送资源无需明确的请求。并且，服务端推送能把客户端所需要的资源伴随index.html一起发送客户端，省去了客户端重复请求的步骤</p> <p><strong>http/2性能瓶颈</strong></p> <p>启用http/2后会给性能带来很大的提升，但同时也带来新的性能瓶颈。因为现在所有的压力都集中在底层一个TCP连接之上，TCP很可能就是下一个性能瓶颈。</p> <h2 id="websocket"><a href="#websocket" class="header-anchor">#</a> websocket</h2> <blockquote><p>WebSocket 是 HTML5 开始提供的一种在单个 TCP 连接上进行全双工通讯的协议。允许服务端主动向客户端推送数据，浏览器和服务器只需要一次握手，俩者之间就可以创建持久性的连接，进行双向数据传输。</p></blockquote> <p><strong>WebSocket 特点</strong></p> <ol><li>通信可以由客户端和服务端双向发送</li> <li>建立在TCP链接之上，服务端比较容易实现</li> <li>与HTTP协议有良好的兼容性。默认端口也是80和443，并且握手阶段采用HTTP协议，因此握手时不容易屏蔽，能通过各种HTTP代理服务器</li> <li>数据格式比较轻量，性能开销小，通信高效</li> <li>可以发送文本，也可以发送二进制数据</li> <li>没有同源限制，客户端可以与任意服务器通信</li> <li>协议标识符是ws（加密为wws），服务器网址就是URL</li></ol> <h2 id="强缓存-协商缓存"><a href="#强缓存-协商缓存" class="header-anchor">#</a> 强缓存&amp;协商缓存</h2> <ol><li><p>什么时候命中强缓冲？max-age / Expires</p></li> <li><p>什么时候命中协商缓冲？未命中强缓存 --》协商缓存的两对请求头</p></li> <li><p>怎么设置缓冲？</p> <ul><li>强缓冲：max-age/Expires</li> <li>协商缓存：Last-Modified/if-Modified-Since；Etag/if-None-Match</li></ul></li> <li><p>怎么设置不缓冲？</p> <ul><li><p>no-store: 缓存中不得存储任何关于客户端请求和服务端响应的内容。每次由客户端发起的请求都会下载完整的响应内容。</p></li> <li><p>no-cache: 每次有请求发出时，缓存会将此请求发到服务器（译者注：该请求应该会带有与本地缓存相关的验证字段），服务器端会验证请求中所描述的缓存是否过期，若未过期（注：实际就是返回304），则缓存才使用本地缓存副本。</p></li></ul></li> <li><p>缓冲中常用头部及用法？</p> <ul><li>Cache-control</li> <li>Last-Modified/if-Modified-Since</li> <li>Etag/if-None-Match</li></ul></li> <li><p>max-age的两种个值？--》注意区别下 cookie 的 max-age</p> <ul><li>0：其实就是走协商缓存，效果等同于 no-cache</li> <li>整数：多少秒后过期</li></ul></li> <li><p>Last-Modified/if-Modified-Since的缺点？</p> <ul><li>不能精确到秒 --》有什么影响？在一秒内修改了，反应不到；文件换了，但内容没改，不会走缓存。</li></ul></li> <li><p>URL + 版本号</p></li></ol> <h2 id="http-的头部"><a href="#http-的头部" class="header-anchor">#</a> http 的头部</h2> <ol><li>请求头包含请求行（请求方法，请求url，版本），首部</li> <li>响应头包含响应行（版本，状态，原因短语），首部</li> <li>head方法：了解资源情况，根据状态码查看某个对象是否存在，测试资源是否被修改</li> <li>options方法：请求web服务器告知其支持的各种功能。可以询问服务器通常支持那些方法，或者对某些特殊资源支持那些方法。</li></ol> <h2 id="http规范"><a href="#http规范" class="header-anchor">#</a> http规范</h2> <ol><li><p>restful</p> <ul><li>协议：使用https</li> <li>域名：应尽量将 api 部署在专有域名之下</li> <li>版本：应将 API 的版本号放入 URL</li> <li>路径：在RESTful架构中，每个网址代表一种资源（resource），所以网址中不能有动词，只能有名词，而且所用的名词往往与数据库的表格名对应。一般来说，数据库中的表都是同种记录的&quot;集合&quot;（collection），所以API中的名词也应该使用复数。</li> <li>HTTP 动词
<ul><li>get 获取</li> <li>post 创建</li> <li>put 在服务器更新资源（客户端提供改变后的完整资源）</li> <li>patch 在服务器更新资源（客户端提供改变的属性）</li> <li>delete 从服务器删除资源</li> <li>head 获取资源的元数据</li> <li>options 获取信息，关于资源的哪些属性是客户端可以改变的</li></ul></li> <li>过滤信息：如果记录数量很多，服务器不可能都将它们返回给用户。API应该提供参数，过滤返回结果。</li> <li>状态码：</li> <li>错误处理：</li> <li>Hypermedia API</li> <li>API的身份认证应该使用OAuth 2.0框架。</li> <li>服务器返回的数据格式，应该尽量使用JSON，避免使用XML。</li></ul></li> <li><p>soa</p></li></ol> <h2 id="tcp-和-udp-的区别"><a href="#tcp-和-udp-的区别" class="header-anchor">#</a> tcp 和 udp 的区别</h2> <p>功能：upd不提供复杂的控制机制，利用IP提供面向无连接的通信服务，是不可靠的传输。TCP面向有连接的通信服务，提供了重发控制，顺序控制，流量控制（窗口大小），拥塞控制（慢启动阈值）等控制机制</p> <p>使用场景：UDP适用于包总量较少的通信（DNS, SNMP）；视频、音频等多媒体通信；广播通信等</p> <h2 id="cdn"><a href="#cdn" class="header-anchor">#</a> CDN</h2> <blockquote><p>CDN 是一个内容分发网络，通过对源网站资源的缓存，利用本身多台位于不同地域、不同运营商的服务器，向用户提供<strong>资源就近访问功能</strong>。有利于提高网站的访问速度，同时通过这种方式也减轻了原服务器的访问压力。</p></blockquote> <p><strong>CDN访问过程</strong></p> <ol><li>用户输入访问的域名，操作系统向 localDNS 查询域名的 IP 地址</li> <li>LocalDNS 向 ROOT DNS 查询域名的授权服务器</li> <li>ROOT DNS 将域名授权 DNS 记录回应给 LocalDNS</li> <li>向域名授权 DNS 查询域名 IP 地址</li> <li>域名授权 DNS 查询域名记录后，回应给 LocalDNS</li> <li>localDNS得到域名记录后，向智能调度 DNS 查询域名的 IP 地址</li> <li>智能调度 DNS 根据一定的算法和策略，将最合适的 CDN 节点 ip 回应给 localDNS</li> <li>LocalDNS将得到的域名 ip 地址，回应给客户端</li> <li>客户端得到域名 ip 地址后，访问站点服务器</li> <li>CDN 节点服务器应答请求，将内容返回给客户端（缓存服务器一方面在本地进行保存，以备后续使用，另一方面把获取的数据返回给客户端，完成数据服务的整个过程）</li></ol></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/基础知识/css.html" class="prev">
          CSS
        </a></span> <span class="next"><a href="/基础知识/浏览器.html">
          浏览器
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.4c273015.js" defer></script><script src="/assets/js/2.2aff70d4.js" defer></script><script src="/assets/js/18.5611296e.js" defer></script>
  </body>
</html>
