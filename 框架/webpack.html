<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Webpack | Elias Notes | Front-End Notes</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/logo.jpeg">
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.f6817f1a.css" as="style"><link rel="preload" href="/assets/js/app.4c273015.js" as="script"><link rel="preload" href="/assets/js/2.2aff70d4.js" as="script"><link rel="preload" href="/assets/js/24.8c84609e.js" as="script"><link rel="prefetch" href="/assets/js/10.f4cbcff0.js"><link rel="prefetch" href="/assets/js/11.4142fc0c.js"><link rel="prefetch" href="/assets/js/12.79cdaa0c.js"><link rel="prefetch" href="/assets/js/13.bf21eec3.js"><link rel="prefetch" href="/assets/js/14.bceb7261.js"><link rel="prefetch" href="/assets/js/15.9a4809fa.js"><link rel="prefetch" href="/assets/js/16.08a352ba.js"><link rel="prefetch" href="/assets/js/17.cc8a0890.js"><link rel="prefetch" href="/assets/js/18.5611296e.js"><link rel="prefetch" href="/assets/js/19.26696b64.js"><link rel="prefetch" href="/assets/js/20.7fb62a04.js"><link rel="prefetch" href="/assets/js/21.e1c074c9.js"><link rel="prefetch" href="/assets/js/22.660cc37e.js"><link rel="prefetch" href="/assets/js/23.4695b80b.js"><link rel="prefetch" href="/assets/js/25.f989ee8a.js"><link rel="prefetch" href="/assets/js/3.0625cd77.js"><link rel="prefetch" href="/assets/js/4.e1c5e78c.js"><link rel="prefetch" href="/assets/js/5.2ca887b4.js"><link rel="prefetch" href="/assets/js/6.830f519f.js"><link rel="prefetch" href="/assets/js/7.90bf487e.js"><link rel="prefetch" href="/assets/js/8.8864ba6b.js"><link rel="prefetch" href="/assets/js/9.fedeec11.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f6817f1a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Elias Notes | Front-End Notes</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="基础" class="dropdown-title"><span class="title">基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="基础" class="mobile-dropdown-title"><span class="title">基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/基础知识/javascript.html" class="nav-link">
    javascript
  </a></li><li class="dropdown-item"><!----> <a href="/基础知识/css.html" class="nav-link">
    css
  </a></li><li class="dropdown-item"><!----> <a href="/基础知识/网络.html" class="nav-link">
    网络
  </a></li><li class="dropdown-item"><!----> <a href="/基础知识/浏览器.html" class="nav-link">
    浏览器
  </a></li><li class="dropdown-item"><!----> <a href="/基础知识/后端.html" class="nav-link">
    后端
  </a></li><li class="dropdown-item"><!----> <a href="/基础知识/计算机.html" class="nav-link">
    计算机
  </a></li><li class="dropdown-item"><!----> <a href="/基础知识/图形学.html" class="nav-link">
    图形学
  </a></li><li class="dropdown-item"><!----> <a href="/基础知识/常用命令.html" class="nav-link">
    常用命令
  </a></li><li class="dropdown-item"><!----> <a href="/基础知识/typescript.html" class="nav-link">
    TypeScript
  </a></li><li class="dropdown-item"><!----> <a href="/基础知识/工具函数.html" class="nav-link">
    工具函数
  </a></li><li class="dropdown-item"><!----> <a href="/基础知识/APIJSON.html" class="nav-link">
    APIJSON
  </a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架" class="dropdown-title"><span class="title">框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="框架" class="mobile-dropdown-title"><span class="title">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/框架/webpack.html" class="nav-link">
    Webpack
  </a></li><li class="dropdown-item"><!----> <a href="/框架/react.html" class="nav-link">
    React
  </a></li><li class="dropdown-item"><!----> <a href="/框架/单体仓库.html" class="nav-link">
    单体仓库
  </a></li><li class="dropdown-item"><!----> <a href="/%E6%A1%86%E6%9E%B6/框架/VUE.html" class="nav-link">
    VUE
  </a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="基础" class="dropdown-title"><span class="title">基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="基础" class="mobile-dropdown-title"><span class="title">基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/基础知识/javascript.html" class="nav-link">
    javascript
  </a></li><li class="dropdown-item"><!----> <a href="/基础知识/css.html" class="nav-link">
    css
  </a></li><li class="dropdown-item"><!----> <a href="/基础知识/网络.html" class="nav-link">
    网络
  </a></li><li class="dropdown-item"><!----> <a href="/基础知识/浏览器.html" class="nav-link">
    浏览器
  </a></li><li class="dropdown-item"><!----> <a href="/基础知识/后端.html" class="nav-link">
    后端
  </a></li><li class="dropdown-item"><!----> <a href="/基础知识/计算机.html" class="nav-link">
    计算机
  </a></li><li class="dropdown-item"><!----> <a href="/基础知识/图形学.html" class="nav-link">
    图形学
  </a></li><li class="dropdown-item"><!----> <a href="/基础知识/常用命令.html" class="nav-link">
    常用命令
  </a></li><li class="dropdown-item"><!----> <a href="/基础知识/typescript.html" class="nav-link">
    TypeScript
  </a></li><li class="dropdown-item"><!----> <a href="/基础知识/工具函数.html" class="nav-link">
    工具函数
  </a></li><li class="dropdown-item"><!----> <a href="/基础知识/APIJSON.html" class="nav-link">
    APIJSON
  </a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架" class="dropdown-title"><span class="title">框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="框架" class="mobile-dropdown-title"><span class="title">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/框架/webpack.html" class="nav-link">
    Webpack
  </a></li><li class="dropdown-item"><!----> <a href="/框架/react.html" class="nav-link">
    React
  </a></li><li class="dropdown-item"><!----> <a href="/框架/单体仓库.html" class="nav-link">
    单体仓库
  </a></li><li class="dropdown-item"><!----> <a href="/%E6%A1%86%E6%9E%B6/框架/VUE.html" class="nav-link">
    VUE
  </a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/框架/webpack.html" class="active sidebar-link">Webpack</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/框架/webpack.html#webpack打包流程" class="sidebar-link">webpack打包流程</a></li><li class="sidebar-sub-header"><a href="/框架/webpack.html#核心babel" class="sidebar-link">核心babel</a></li><li class="sidebar-sub-header"><a href="/框架/webpack.html#优化配置" class="sidebar-link">优化配置</a></li><li class="sidebar-sub-header"><a href="/框架/webpack.html#css处理" class="sidebar-link">css处理</a></li><li class="sidebar-sub-header"><a href="/框架/webpack.html#热更新" class="sidebar-link">热更新</a></li><li class="sidebar-sub-header"><a href="/框架/webpack.html#异步组件" class="sidebar-link">异步组件</a></li><li class="sidebar-sub-header"><a href="/框架/webpack.html#plugin" class="sidebar-link">plugin</a></li><li class="sidebar-sub-header"><a href="/框架/webpack.html#常用的webpack插件" class="sidebar-link">常用的webpack插件</a></li><li class="sidebar-sub-header"><a href="/框架/webpack.html#webpack的优秀特点" class="sidebar-link">webpack的优秀特点</a></li></ul></li><li><a href="/框架/react.html" class="sidebar-link">React</a></li><li><a href="/框架/单体仓库.html" class="sidebar-link">单体仓库</a></li><li><a href="/框架/VUE.html" class="sidebar-link">VUE</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="webpack"><a href="#webpack" class="header-anchor">#</a> Webpack</h1> <h2 id="webpack打包流程"><a href="#webpack打包流程" class="header-anchor">#</a> webpack打包流程</h2> <p>初始化合并参数 --》 根据参数创建 complier 实例 --》 完成一系列plugins的订阅 --》获取入口文件 --》 模块编译，各自文件的loader开始工作，最后根据依赖关系生成chunk --》 完成编译 --》输出文件</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Complier</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>hooks <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token comment">// 开始编译时的钩子</span>
      <span class="token literal-property property">run</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">SyncHook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token comment">// 输出asset到oupput目录之前执行</span>
      <span class="token literal-property property">emit</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">SyncHook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token comment">// 在 compliation 完成时执行 全部完成编译执行</span>
      <span class="token literal-property property">done</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">SyncHook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token function">run</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">webpack</span><span class="token punctuation">(</span><span class="token parameter">option</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> mergeOptions <span class="token operator">=</span> <span class="token function">_mergeOptions</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span>
  <span class="token keyword">const</span> complier <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Complier</span><span class="token punctuation">(</span>mergeOptions<span class="token punctuation">)</span>
  <span class="token keyword">return</span> complier
<span class="token punctuation">}</span>

<span class="token keyword">const</span> complier <span class="token operator">=</span> webpac
complier<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="核心babel"><a href="#核心babel" class="header-anchor">#</a> 核心babel</h2> <div class="language-js extra-class"><pre class="language-js"><code>@babel<span class="token operator">/</span>core @babel<span class="token operator">/</span>preset<span class="token operator">-</span>env babel<span class="token operator">-</span>loader <span class="token operator">--</span><span class="token operator">&gt;</span> 必备
@babel<span class="token operator">/</span>preset<span class="token operator">-</span>react <span class="token operator">--</span><span class="token operator">&gt;</span> react语法解析
@babel<span class="token operator">/</span>plugin<span class="token operator">-</span>proposal<span class="token operator">-</span>decorators <span class="token operator">--</span><span class="token operator">&gt;</span> 装饰器
<span class="token comment">/**
 * babel 默认只转化新的 javascript 语法，如箭头函数等，而不转化新的API，
 * 如Iterator, Generator, Set, Map, Proxy, Reflect, Symbol, Promise
 * 等全局对象，此时需要一些辅助函数（babel 6.x 一下版本借助 polyfill，需要在entry之前或根文件头部引入，babel7使用下面的插件）
 * 
 */</span>
@babel<span class="token operator">/</span>plugin<span class="token operator">-</span>transform<span class="token operator">-</span>runtime
</code></pre></div><h2 id="优化配置"><a href="#优化配置" class="header-anchor">#</a> 优化配置</h2> <blockquote><p>将一些不变的包进行缓存，再次打包的时候只打包缓存之外的包。
需要配合插件将生成的包自动引入到模板 html 文件</p></blockquote> <ul><li>使用</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 统一打包到 vendor.js </span>
<span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">splitChunks</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">cacheGroups</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">vendor</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">'vendor.js'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">'all'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\\/]node_modules[\\/](react|react-dom)[\\/]</span><span class="token regex-delimiter">/</span></span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 分开打包到多个文件</span>
<span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">splitChunks</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">cacheGroups</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">react</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">'react.js'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">'all'</span><span class="token punctuation">,</span> <span class="token comment">// async, initial</span>
        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\\/]node_modules[\\/]react[\\/]</span><span class="token regex-delimiter">/</span></span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token string-property property">'react-dom'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">'react-dom.js'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">'all'</span><span class="token punctuation">,</span> <span class="token comment">// async, initial</span>
        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\\/]node_modules[\\/]react-dom[\\/]</span><span class="token regex-delimiter">/</span></span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="css处理"><a href="#css处理" class="header-anchor">#</a> css处理</h2> <div class="language-js extra-class"><pre class="language-js"><code>css<span class="token operator">-</span>loader <span class="token operator">--</span><span class="token operator">&gt;</span> 处理 css 的一些依赖关系
style<span class="token operator">-</span>loader <span class="token operator">--</span><span class="token operator">&gt;</span> css<span class="token operator">-</span>loader 生成的样式通过 style 标签插入到 dom 中

mini<span class="token operator">-</span>css<span class="token operator">-</span>extract<span class="token operator">-</span>plugin <span class="token operator">--</span><span class="token operator">&gt;</span> 将 css<span class="token operator">-</span>loader 生成的标签抽离到单独文件。<span class="token keyword">new</span> 后 包含loader，代替 style loader。

html<span class="token operator">-</span>webpack<span class="token operator">-</span>plugin <span class="token operator">--</span><span class="token operator">&gt;</span> 将生成的css文件和js文件插入 dom

<span class="token comment">// sass</span>
sass<span class="token operator">-</span>loader  node<span class="token operator">-</span>sass

<span class="token comment">// less</span>
less<span class="token operator">-</span>loader  less
</code></pre></div><h2 id="热更新"><a href="#热更新" class="header-anchor">#</a> 热更新</h2> <ol><li>使用</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// webpack 配置</span>
devServer <span class="token punctuation">{</span>
  <span class="token literal-property property">port</span><span class="token operator">:</span> <span class="token number">8000</span><span class="token punctuation">,</span>
  <span class="token literal-property property">hot</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>


<span class="token comment">// 入口文件加入 module.hot</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>module<span class="token punctuation">.</span>hot<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">.</span>hot<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span>App<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>App<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>App<span class="token operator">&gt;</span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'app'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="2"><li>原理
首次启动：
源代码--》编译=》bundle.js产物=》浏览器访问端口=》服务器返回静态资源
浏览器于dev-server简历socket连接，首次收到hash</li></ol> <p>更新：
源代码修改=》增量编译=》HRM（基于新内容生成[hash].update.json [hash].update.js）=&gt; 向浏览器推送消息（包括新的hash）=》浏览器创建script标签下载生成的新文件=》调用页面的更新方法（module.hot.accept）</p> <ol start="3"><li>The Compiler supports watching which monitors the file system and recompiles as files change</li></ol> <h2 id="异步组件"><a href="#异步组件" class="header-anchor">#</a> 异步组件</h2> <ol><li>import()函数返回promise，可以利用此语法动态加载模块。达到异步的加载的效果。</li> <li>import()函数为 webpack 提供了代码分隔的依据，import() 导入的模块单独打包。</li> <li>require.ensure()也是非常流行的一个代码异步加载的方式。语法如下：</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>require<span class="token punctuation">.</span><span class="token function">ensure</span><span class="token punctuation">(</span>
  <span class="token literal-property property">dependencies</span><span class="token operator">:</span> String<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 依赖项</span>
  <span class="token function-variable function">callback</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">require</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 加载组件完成回调</span>
  errorCallback<span class="token operator">?</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 加载失败回调</span>
  chunkName<span class="token operator">?</span><span class="token operator">:</span> String <span class="token comment">// 指定产出块名称</span>
<span class="token punctuation">)</span>
<span class="token comment">// eg</span>
require<span class="token punctuation">.</span><span class="token function">ensure</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> ensure <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span>'<span class="token punctuation">.</span><span class="token operator">/</span>requireEnsure<span class="token punctuation">)</span><span class="token punctuation">;</span>
  ensure<span class="token punctuation">.</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">'require-ensure'</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="plugin"><a href="#plugin" class="header-anchor">#</a> plugin</h2> <ol><li>特点：需要导入并实例化，通过勾子可以设计整个构建流程，因此贯穿整个构建范围。</li> <li>本质：原型上具有apply方法的具名构造函数或类</li> <li>原型上的 apply 方法就是“通过webpck在不同阶段提供的事件钩子来操纵其内部实例的特定的数据，最后调用webpack提供的回调”的函数。</li> <li>complier钩子:</li></ol> <blockquote><p>Complee 模块是webpack的支柱引擎，他通过cli或Node API传递的所有选项，创建出一个compliation实例。它继承自tapable类，以便注册和调用插件</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 编译对象初始化后执行</span>
initialize
<span class="token comment">// complier.run()执行之前的一个钩子，param: complier </span>
beforeRun
<span class="token comment">// 编译 complication 参数创建之后，执行插件</span>
beforeCompile
<span class="token comment">// 编译 complication 创建之后，执行插件</span>
complication 
<span class="token comment">// 生成资源到output目录之后</span>
afterEmit 
<span class="token comment">// 编译完成</span>
done 
<span class="token comment">// 编译失败</span>
failed 

<span class="token comment">// eg: html-webpack-plugin </span>
compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>initialize<span class="token punctuation">.</span>tap
compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>thisCompilation<span class="token punctuation">.</span>tap
compilation<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>processAssets<span class="token punctuation">.</span>tapAsync

</code></pre></div><ol start="5"><li>complication钩子</li></ol> <blockquote><p>同样继承自tapable</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 当一个模块构建开始前执行</span>
buildModule

<span class="token comment">// 当一个模块构建成功</span>
succeedModule

<span class="token comment">// 当所有模块构建成功执行</span>
finishModules

<span class="token comment">// 当开始优化依赖时执行</span>
optimizeDependencied

<span class="token comment">// 当完成优化依赖时执行</span>
afterOptimizeDependencies

</code></pre></div><ol start="6"><li><p>插件类型
Tapable这个小型的library是webpack的一个核心工具，但也可以用于其他地方，以提供类似的插件接口。这个类暴露<code>tap</code>, <code>tapAsync</code>, <code>tapPromise</code>方法，可以使用这些方法，注入自定义的构建步骤</p></li> <li><p>用法</p></li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">TemplatedPathPlugin</span> <span class="token punctuation">{</span>
  <span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>run<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span>plugin<span class="token punctuation">,</span> <span class="token parameter">compilation</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      compilation<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>optimize<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span>plugin<span class="token punctuation">,</span> replacePathVariables<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="常用的webpack插件"><a href="#常用的webpack插件" class="header-anchor">#</a> 常用的webpack插件</h2> <ol><li>html-webpack-plugin：生成一个html文件 将 js css外联到html</li> <li>clean-webpack-plugin：清理上一次项目生成的bundle文件</li> <li>extract-text-webpack-plugin：将 css 生成文件而非内联</li> <li>UglifyJsPlugin：对 js 文件进行压缩。单线程</li> <li>ParallelUglifyPlugin： 并行压缩 js 代码</li> <li>compression-webpack-plugin：gzip压缩</li> <li>copy-webpack-plugin：将静态资源拷贝到 dist 目录</li> <li>DllPlugin：提供分离打包的方法</li></ol> <h2 id="webpack的优秀特点"><a href="#webpack的优秀特点" class="header-anchor">#</a> webpack的优秀特点</h2> <ol><li><p>代码分割
分离第三方库
CommonsChunkPlugin</p></li> <li><p>按工程需求进行分割 ： syntax-dynamic-import
webpack 把 import(静态路径) 作为一个分离点(split-point)，并把引入的模块作为一个单独的 chunk</p></li> <li><p>按需引入
babel-plugin-import</p></li></ol></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/框架/react.html">
          React
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.4c273015.js" defer></script><script src="/assets/js/2.2aff70d4.js" defer></script><script src="/assets/js/24.8c84609e.js" defer></script>
  </body>
</html>
